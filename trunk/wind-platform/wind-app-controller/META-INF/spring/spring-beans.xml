<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">


	<bean name="appModelListenerRegistryCtrl" scope="singleton"
		class="br.com.maisha.wind.common.listener.AppModelListenerRegistry" />

	<bean name="persistentStorage" scope="singleton"
		class="br.com.maisha.wind.controller.storage.PersistentStorage" />	
	
	<bean name="applicationController" scope="singleton"
		class="br.com.maisha.wind.controller.ApplicationController">
		<property name="modelListener" ref="appModelListenerRegistryOsgi" />
		<property name="validatorRegisty" ref="validatorRegisty" />
		<property name="persistentStorage" ref="persistentStorage"/>
	</bean>


	<bean name="validatorRegisty"
		class="br.com.maisha.wind.controller.validator.ValidatorRegistry">
		<property name="registry">
			<map>
				<entry key="max_length" value-ref="maxLengthValidator" />
				<entry key="required" value-ref="requiredValidator" />
				<entry key="min_length" value-ref="minLengthValidator" />
			</map>
		</property>
	</bean>

	<bean name="messageRegisty"
		class="br.com.maisha.wind.controller.message.PlatformMessageRegistry"
		scope="singleton" init-method="init">
		<property name="preferences" ref="preferencesServiceOsgi" />
		<property name="messageBundles">
			<list>
				<ref bean="messageSource" />
			</list>
		</property>
	</bean>

	<bean name="maxLengthValidator"
		class="br.com.maisha.wind.controller.validator.MaxLengthValidator" />

	<bean name="minLengthValidator"
		class="br.com.maisha.wind.controller.validator.MinLengthValidator" />

	<bean name="requiredValidator"
		class="br.com.maisha.wind.controller.validator.RequiredValidator" />

	<bean id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
		<property name="basename" value="messages" />
	</bean>

</beans>


